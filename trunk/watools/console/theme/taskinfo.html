<script language="javascript">
function goBack()
{
	$("#mainView").load('/tasks.php');
	return false;
}
function toggleView(view)
{
	v = $('#'+view).attr('visible');
	if (v == 0) {
		$('#'+view).attr('visible', '1');
		$('#'+view).show();
		$('#'+view+"_btn").removeClass('ui-icon-plus');
		$('#'+view+"_btn").addClass('ui-icon-minus');
	}
	else {
		$('#'+view).attr('visible', '0');
		$('#'+view).hide();
		$('#'+view+"_btn").removeClass('ui-icon-minus');
		$('#'+view+"_btn").addClass('ui-icon-plus');
	}
	return false;
}
</script>
<h3 class="ui-widget-header-h3">Task - [{$target}] (started at [{$startTime}])</h3>
<div style="margin: 20;">
<a href="#" onclick="return goBack();"><span class="ui-icon ui-icon-circle-arrow-n ui-icon-btn" title="Return to Task List"></span>Return to Task List</a><br/>
<h4 class="ui-widget-header"><a href="#" onclick="return toggleView('summary');">
	<span class="ui-icon ui-icon-minus ui-icon-btn" id="summary_btn" title="Objects"></span></a>Summary</h4>
	<table width="100%" id='summary' visible="1">
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Scan started:</b></td><td>[{$scanStart}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Scan finished:</b></td><td>[{$scanStop}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Last activity:</b></td><td>[{$scanPing}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Scan duration:</b></td><td>[{$scanLen}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Objects found:</b></td><td>[{$scCount}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Vulnerabilities found:</b></td><td>[{$vlCount}]</td></tr>
	<tr><td style="white-space: nowrap; text-align: left;width: 50;"><b>Scan speed:</b></td><td>[{$scanSpeed}]</td></tr>
	</table>
<br/>
<h4 class="ui-widget-header"><a href="#" onclick="return toggleView('objects');">
	<span class="ui-icon ui-icon-plus ui-icon-btn" id="objects_btn" title="Objects"></span></a>Objects found ([{$scCount}])</h4>
[{if $scCount > 0}]
	<table width="100%" id='objects' style="display: none;" visible="0">
		<tr class="ui-widget-header">
			<th style="width: 5%;">ID</th>
			<th style="width: auto;">URL</th>
			<th style="width: auto;">Response code</th>
			<th style="width: auto;">Data size</th>
			<th style="width: auto;">Content type</th>
		</tr>
[{section name=sc loop=$scdata}]<tr>
			<td style="white-space: nowrap; text-align: center;">[{$scdata[sc][0]}]</td>
			<td style="white-space: nowrap; text-align: left;">[{$scdata[sc][3]}]</td>
			<td style="width: auto; text-align: center;">[{$scdata[sc][5]}]</td>
			<td style="width: auto; text-align: center;">[{$scdata[sc][6]}]</td>
			<td style="width: auto; text-align: center;">[{$scdata[sc][8]}]</td>
		</tr>
            [{/section}]
	</table>
[{else}]
	<div class="ui-state-error ui-corner-all" width="100%" id='objects' style="padding: 5px;" visible="1">
		<span style="float: left; margin-right: 0.3em;" class="ui-icon ui-icon-alert"></span>
		No objects found!
	</div>
[{/if}]
<br/>
<h4 class="ui-widget-header"><a href="#" onclick="return toggleView('vulners');">
	<span class="ui-icon ui-icon-plus ui-icon-btn" id="vulners_btn" title="Objects"></span></a>Vulnerabilities found ([{$vlCount}])</h4>
[{if $vlCount > 0}]
	<table width="100%" id='vulners' style="display: none;" visible="0">
		<tr class="ui-widget-header">
			<th style="width: 5%;">Object ID</th>
			<th style="width: 15%;">Code</th>
			<th style="width: auto;">Title</th>
			<th style="width: 5%;">Severity</th>
			<th style="width: auto;">Param</th>
		</tr>
[{section name=vl loop=$vldata}]<tr>
			<td style="white-space: nowrap; text-align: left;">[{$vldata[vl][0]}]</td>
			<td style="width: auto; text-align: center;">[{$vldata[vl][1]}]</td>
			<td style="width: auto; text-align: center;">[{$vldata[vl][2]}]</td>
			<td style="width: auto; text-align: center;">[{$vldata[vl][3]}]</td>
			<td style="width: auto; text-align: center;">[{$vldata[vl][4]}]</td>
		</tr>
            [{/section}]
	</table>
[{else}]
	<div class="ui-state-error ui-corner-all" width="100%" id='vulners' style="padding: 5px;" visible="1">
		<span style="float: left; margin-right: 0.3em;" class="ui-icon ui-icon-alert"></span>
		No objects found!
	</div>
[{/if}]
<br/>
<a href="#" onclick="return goBack();"><span class="ui-icon ui-icon-circle-arrow-n ui-icon-btn" title="Return to Task List"></span>Return to Task List</a><br/>
</div>